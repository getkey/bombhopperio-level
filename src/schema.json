{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://bombhopper.io/level.schema.json",
	"definitions": {
		"point": {
			"type": "object",
			"additionalProperties": false,
			"required": ["x", "y"],
			"properties": {
				"x": {
					"type": "number"
				},
				"y": {
					"type": "number"
				}
			}
		},
		"start_timing": {
			"type": "integer",
			"minimum": 0
		},
		"entity": {
			"type": "object",
			"additionalProperties": false,
			"required": ["type", "params"],
			"properties": {
				"type": {
					"type": "string"
				},
				"params": {
					"type": "object"
				}
			}
		}
	},
	"title": "Level",
	"description": "A BombHopper.io level",
	"type": "object",
	"additionalProperties": false,
	"required": ["name", "timings", "entities"],
	"properties": {
		"name": {
			"type": "string",
			"description": "The level's name",
			"minLength": 1
		},
		"timings": {
			"type": "array",
			"items": [
				{
					"description": "2 stars",
					"$ref": "#/definitions/start_timing"
				},
				{
					"description": "3 stars",
					"$ref": "#/definitions/start_timing"
				}
			],
			"minItems": 2,
			"additionalItems": false
		},
		"formatVersion": {
			"type": "integer",
			"description": "The version number of the schema the file corresponds to",
			"minimum": 0
		},
		"entities": {
			"type": "array",
			"items": {
				"oneOf": [
					{
						"allOf": [
							{
								"$ref": "#/definitions/entity"
							},
							{
								"properties": {
									"type": {
										"enum": ["normal", "ice", "bouncy", "breakable", "deadly"]
									},
									"params": {
										"oneOf": [
											{
												"type": "object",
												"additionalProperties": false,
												"required": ["vertices"],
												"properties": {
													"isStatic": {
														"type": "boolean"
													},
													"vertices": {
														"type": "array",
														"minItems": 3,
														"items": { "$ref": "#/definitions/point" }
													}
												}
											},
											{
												"type": "object",
												"additionalProperties": false,
												"required": ["x", "y", "radius"],
												"properties": {
													"isStatic": {
														"type": "boolean"
													},
													"x": {
														"type": "number"
													},
													"y": {
														"type": "number"
													},
													"radius": {
														"type": "number",
														"exclusiveMinimum": 0
													}
												}
											}
										]
									}
								}
							}
						]
					},
					{
						"allOf": [
							{
								"$ref": "#/definitions/entity"
							},
							{
								"properties": {
									"type": {
										"const": "text"
									},
									"params": {
										"type": "object",
										"additionalProperties": false,
										"required": ["x", "y", "copy", "anchor"],
										"properties": {
											"x": {
												"type": "number"
											},
											"y": {
												"type": "number"
											},
											"copy": {
												"type": "object",
												"required": ["en"],
												"additionalProperties": {
													"type": "string"
												},
												"properties": {
													"en": {
														"type": "string"
													}
												}
											},
											"anchor": { "$ref": "#/definitions/point" },
											"angle": {
												"type": "number"
											}
										}
									}
								}
							}
						]
					},
					{
						"allOf": [
							{
								"$ref": "#/definitions/entity"
							},
							{
								"properties": {
									"type": {
										"const": "endpoint"
									},
									"params": {
										"type": "object",
										"additionalProperties": false,
										"required": ["x", "y", "isStatic", "angle"],
										"properties": {
											"x": {
												"type": "number"
											},
											"y": {
												"type": "number"
											},
											"isStatic": {
												"type": "boolean"
											},
											"rightFacing": {
												"type": "boolean"
											},
											"angle": {
												"type": "number"
											}
										}
									}
								}
							}
						]
					},
					{
						"allOf": [
							{
								"$ref": "#/definitions/entity"
							},
							{
								"properties": {
									"type": {
										"const": "player"
									},
									"params": {
										"oneOf": [
											{
												"type": "object",
												"additionalProperties": false,
												"required": ["x", "y", "angle", "magazine"],
												"properties": {
													"x": {
														"type": "number"
													},
													"y": {
														"type": "number"
													},
													"isStatic": {
														"type": "boolean"
													},
													"rightFacing": {
														"type": "boolean"
													},
													"angle": {
														"type": "number"
													},
													"magazine": {
														"type": "array",
														"items": {
															"enum": ["grenade", "bullet", "empty"]
														}
													}
												}
											},
											{
												"type": "object",
												"additionalProperties": false,
												"required": ["x", "y", "angle", "infiniteAmmo"],
												"properties": {
													"x": {
														"type": "number"
													},
													"y": {
														"type": "number"
													},
													"isStatic": {
														"type": "boolean"
													},
													"rightFacing": {
														"type": "boolean"
													},
													"angle": {
														"type": "number"
													},
													"infiniteAmmo": {
														"enum": ["grenade", "bullet"]
													}
												}
											}
										]
									}
								}
							}
						]
					}
				]
			}
		}
	}
}
